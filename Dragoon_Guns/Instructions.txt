1. Set the Limited Uses to "Charges" with a Maximum value of 3.
2. Set the Attack Count Formula to "@item.uses.value - 1" (without the " marks) in the Formulaic Extra Attacks section of the attack/action.
3. Copy and paste the contents of "Gun_script_call.js" into a new script macro under the "Use" event on the Advanced tab of the attack.